# –†–µ—à–µ–Ω–∏—è –ø–æ –∫–∏—Ä–∏–ª–ª–∏—á–µ—Å–∫–æ–π –ø–æ–¥–¥–µ—Ä–∂–∫–µ PDF

**–î–∞—Ç–∞:** 2025-01-27  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –£—Ç–≤–µ—Ä–∂–¥–µ–Ω–æ –∏ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–æ

## DECISION-PDF-ENGINE-001: HTML‚ÜíPDF —á–µ—Ä–µ–∑ Puppeteer

**–ü—Ä–æ–±–ª–µ–º–∞:** jsPDF –∏ –¥—Ä—É–≥–∏–µ –∫–ª–∏–µ–Ω—Ç—Å–∫–∏–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç –∫–∏—Ä–∏–ª–ª–∏—Ü—É –∏–∑ –∫–æ—Ä–æ–±–∫–∏.

**–†–µ—à–µ–Ω–∏–µ:** –ü–µ—Ä–µ—Ö–æ–¥ –Ω–∞ server-side –≥–µ–Ω–µ—Ä–∞—Ü–∏—é PDF —á–µ—Ä–µ–∑ Puppeteer + HTML‚ÜíPDF —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥.

**–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞:**
- **–û—Å–Ω–æ–≤–Ω–æ–π –¥–≤–∏–∂–æ–∫:** Puppeteer —Å –ª–æ–∫–∞–ª—å–Ω—ã–º Chrome (development) –∏–ª–∏ Chromium (production)
- **HTML —à–∞–±–ª–æ–Ω:** –ü–æ–ª–Ω–æ—Ü–µ–Ω–Ω—ã–π HTML —Å CSS –∏ –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–º–∏ —à—Ä–∏—Ñ—Ç–∞–º–∏
- **Fallback:** –í–Ω–µ—à–Ω–∏–π API (HTMLPDF API) –∏–ª–∏ —Ç–µ–∫—Å—Ç–æ–≤—ã–π —ç–∫—Å–ø–æ—Ä—Ç
- **API endpoint:** `/api/generate-pdf` —Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–º —Å–∫–∞—á–∏–≤–∞–Ω–∏–µ–º

**–§–∞–π–ª—ã:**
- `app/api/generate-pdf/route.ts` - –æ—Å–Ω–æ–≤–Ω–æ–π API endpoint
- `lib/pdf-html-template.ts` - HTML —à–∞–±–ª–æ–Ω —Å CSS
- `lib/pdf-fallback.ts` - fallback —Ä–µ—à–µ–Ω–∏—è
- `public/fonts/` - Noto Sans —à—Ä–∏—Ñ—Ç—ã –¥–ª—è –∫–∏—Ä–∏–ª–ª–∏—Ü—ã

## FONT-POLICY-001: –ö–∏—Ä–∏–ª–ª–∏—á–µ—Å–∫–∏–µ —à—Ä–∏—Ñ—Ç—ã

**–ü—Ä–æ–±–ª–µ–º–∞:** –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ —à—Ä–∏—Ñ—Ç—ã –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç –∫–∏—Ä–∏–ª–ª–∏—Ü—É –≤ PDF.

**–†–µ—à–µ–Ω–∏–µ:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ Noto Sans —Å –ø–æ–ª–Ω–æ–π –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π Unicode.

**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è:**
```css
@font-face {
  font-family: 'Noto Sans';
  src: url('/fonts/NotoSans-Regular.ttf') format('truetype');
  font-weight: 400;
  unicode-range: U+0400-04FF, U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
```

**–®—Ä–∏—Ñ—Ç—ã:**
- `NotoSans-Regular.ttf` - –æ—Å–Ω–æ–≤–Ω–æ–π —à—Ä–∏—Ñ—Ç
- `NotoSans-Bold.ttf` - –∂–∏—Ä–Ω—ã–π —à—Ä–∏—Ñ—Ç
- –ü—Ä–µ–¥–∑–∞–≥—Ä—É–∑–∫–∞ —á–µ—Ä–µ–∑ `<link rel="preload">`

## BACKUP-PDF-SERVICE-001: –ú–Ω–æ–≥–æ—É—Ä–æ–≤–Ω–µ–≤—ã–π Fallback

**–ü—Ä–æ–±–ª–µ–º–∞:** Puppeteer –º–æ–∂–µ—Ç –Ω–µ —Ä–∞–±–æ—Ç–∞—Ç—å –≤ –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è—Ö.

**–†–µ—à–µ–Ω–∏–µ:** –¢—Ä–µ—Ö—É—Ä–æ–≤–Ω–µ–≤–∞—è —Å–∏—Å—Ç–µ–º–∞ fallback:

1. **Puppeteer** (–æ—Å–Ω–æ–≤–Ω–æ–π) - HTML‚ÜíPDF —á–µ—Ä–µ–∑ Chrome/Chromium
2. **–í–Ω–µ—à–Ω–∏–π API** (HTMLPDF API) - –æ–±–ª–∞—á–Ω—ã–π —Å–µ—Ä–≤–∏—Å
3. **–¢–µ–∫—Å—Ç–æ–≤—ã–π —ç–∫—Å–ø–æ—Ä—Ç** (–ø–æ—Å–ª–µ–¥–Ω–∏–π resort) - –ø—Ä–æ—Å—Ç–æ–π —Ç–µ–∫—Å—Ç–æ–≤—ã–π —Ñ–∞–π–ª

**–õ–æ–≥–∏–∫–∞:**
```typescript
try {
  // Puppeteer
  return await generatePDFWithPuppeteer();
} catch (error) {
  try {
    // –í–Ω–µ—à–Ω–∏–π API
    return await generatePDFWithExternalAPI();
  } catch (fallbackError) {
    // –¢–µ–∫—Å—Ç–æ–≤—ã–π —ç–∫—Å–ø–æ—Ä—Ç
    return await generateTextExport();
  }
}
```

## PUPPETEER-CONFIG-001: –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –¥–ª—è —Ä–∞–∑–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏–π

**Development:**
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç –ª–æ–∫–∞–ª—å–Ω—ã–π Google Chrome
- –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–µ –∞—Ä–≥—É–º–µ–Ω—Ç—ã –∑–∞–ø—É—Å–∫–∞
- –û—Ç–ª–∞–¥–æ—á–Ω—ã–µ –ª–æ–≥–∏

**Production:**
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç Chromium –¥–ª—è serverless
- –ü–æ–ª–Ω—ã–µ –∞—Ä–≥—É–º–µ–Ω—Ç—ã Chromium
- –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

**–ö–æ–¥:**
```typescript
const executablePath = process.env.NODE_ENV === 'development' 
  ? '/Applications/Google Chrome.app/Contents/MacOS/Google Chrome'
  : await chromium.executablePath();

const args = process.env.NODE_ENV === 'development'
  ? ['--no-sandbox', '--disable-setuid-sandbox', '--disable-dev-shm-usage']
  : chromium.args;
```

## HTML-TEMPLATE-001: –°—Ç—Ä—É–∫—Ç—É—Ä–∞ PDF —à–∞–±–ª–æ–Ω–∞

**–§–æ—Ä–º–∞—Ç:** A4 —Å –ø–æ–ª—è–º–∏ 24mm
**–°–µ–∫—Ü–∏–∏:**
1. Header (–≥—Ä–∞–¥–∏–µ–Ω—Ç–Ω—ã–π —Ñ–æ–Ω, –∏–º—è + –≥–æ—Ä–æ–¥ + –∂–∞–Ω—Ä—ã)
2. Elevator Pitch (–∫—Ä–∞—Ç–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ)
3. Biography (–ø–æ–ª–Ω–æ–µ BIO)
4. Key Highlights (—Å–ø–∏—Å–æ–∫ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π)
5. Links (—Å–æ—Ü–∏–∞–ª—å–Ω—ã–µ —Å–µ—Ç–∏)
6. Footer (–¥–∞—Ç–∞ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏)

**CSS –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:**
- `@page` –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –¥–ª—è A4
- `page-break-inside: avoid` –¥–ª—è —Å–µ–∫—Ü–∏–π
- –ì—Ä–∞–¥–∏–µ–Ω—Ç–Ω—ã–π header
- –°—Ç–∏–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ —Å–ø–∏—Å–∫–∏ —Å –∏–∫–æ–Ω–∫–∞–º–∏

## TESTING-001: –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–∏—Ä–∏–ª–ª–∏—Ü—ã

**–¢–µ—Å—Ç–æ–≤—ã–µ —Å–∏–º–≤–æ–ª—ã:**
- `—ë, –ô` - —Å–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã–µ —Ä—É—Å—Å–∫–∏–µ –±—É–∫–≤—ã
- `¬´–∫–∞–≤—ã—á–∫–∏¬ª` - —Ç–∏–ø–æ–≥—Ä–∞—Ñ—Å–∫–∏–µ –∫–∞–≤—ã—á–∫–∏
- `‚Äî` - –¥–ª–∏–Ω–Ω–æ–µ —Ç–∏—Ä–µ
- `—ç–º–æ–¥–∑–∏ üéµ` - Unicode —Å–∏–º–≤–æ–ª—ã

**–ü—Ä–æ–≤–µ—Ä–∫–∞:**
- –í—Å–µ —Å–∏–º–≤–æ–ª—ã –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
- –ù–µ—Ç "–∫–≤–∞–¥—Ä–∞—Ç–∏–∫–æ–≤" –∏–ª–∏ –∏—Å–∫–∞–∂–µ–Ω–∏–π
- –®—Ä–∏—Ñ—Ç —á–∏—Ç–∞–±–µ–ª—å–Ω—ã–π –∏ —á–µ—Ç–∫–∏–π

## ACCEPTANCE-CRITERIA

‚úÖ `/api/generate-pdf` —Ñ–æ—Ä–º–∏—Ä—É–µ—Ç PDF —Å —Ä—É—Å—Å–∫–∏–º —Ç–µ–∫—Å—Ç–æ–º –±–µ–∑ –∞—Ä—Ç–µ—Ñ–∞–∫—Ç–æ–≤  
‚úÖ –í PDF –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è –∑–Ω–∞–∫–∏ ¬´–Å/—ë¬ª, ¬´‚Äî¬ª, –∫–∞–≤—ã—á–∫–∏ ¬´¬ª –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ  
‚úÖ PDF –æ–¥–∏–Ω–∞–∫–æ–≤ –Ω–∞ dev –∏ serverless-–æ–∫—Ä—É–∂–µ–Ω–∏–∏  
‚úÖ –ü—Ä–∏ –ø–∞–¥–µ–Ω–∏–∏ Chromium ‚Äî –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π —Ä–µ—Ç—Ä–∞–π —á–µ—Ä–µ–∑ –≤–Ω–µ—à–Ω–∏–π –ø—Ä–æ–≤–∞–π–¥–µ—Ä  
‚úÖ –í —Ä–µ–ø–æ –µ—Å—Ç—å –∫–∏—Ä–∏–ª–ª–∏—Ü–∞-—Ç–µ—Å—Ç –∏ —Å–∫—Ä–∏–Ω-–ø—Ä–∏–º–µ—Ä —É—Å–ø–µ—à–Ω–æ —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ PDF  

## –†–ï–ó–£–õ–¨–¢–ê–¢

**–°—Ç–∞—Ç—É—Å:** ‚úÖ –£–°–ü–ï–®–ù–û –†–ï–ê–õ–ò–ó–û–í–ê–ù–û –ò –ü–†–û–¢–ï–°–¢–ò–†–û–í–ê–ù–û

- PDF –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –±–µ–∑ –¥–∏–∞–ª–æ–≥–æ–≤
- –ö–∏—Ä–∏–ª–ª–∏—Ü–∞ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –≤–æ –≤—Å–µ—Ö —Å–µ–∫—Ü–∏—è—Ö
- –ü—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–π –¥–∏–∑–∞–π–Ω —Å –≥—Ä–∞–¥–∏–µ–Ω—Ç–Ω—ã–º –∑–∞–≥–æ–ª–æ–≤–∫–æ–º
- –°—Ç–∞–±–∏–ª—å–Ω–∞—è —Ä–∞–±–æ—Ç–∞ –≤ development –∏ production
- Fallback —Å–∏—Å—Ç–µ–º–∞ –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç—å

**–§–∞–π–ª—ã –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏:**
- `app/api/generate-pdf/route.ts`
- `lib/pdf-html-template.ts`
- `lib/pdf-fallback.ts`
- `public/fonts/NotoSans-*.ttf`
- `.taskmaster/docs/decisions-cyrillic-pdf.md` (—ç—Ç–æ—Ç —Ñ–∞–π–ª)
