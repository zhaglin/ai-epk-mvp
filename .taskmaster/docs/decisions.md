# Архитектурные решения AI-EPK MVP

## DECISION-001: Технологический стек и архитектура

**Дата:** 2025-10-09  
**Статус:** Утверждено

### Контекст
Необходимо определить технологический стек для MVP проекта AI-EPK, обеспечивающий быструю разработку, простоту деплоя и минимальные издержки.

### Решение

#### Frontend
- **Framework:** Next.js 14 (App Router)
- **UI Library:** React 18+
- **Language:** TypeScript
- **Styling:** TailwindCSS
- **Rationale:** 
  - Next.js обеспечивает SSR, отличную DX, встроенный API routing
  - TypeScript для type safety и лучшей DX
  - TailwindCSS для быстрого прототипирования и минималистичного дизайна

#### Backend
- **API:** Next.js API Routes (serverless)
- **AI Provider:** OpenAI GPT-4o-mini
- **PDF Generation:** Puppeteer (или react-pdf как альтернатива)
- **Rationale:**
  - Serverless для простоты и масштабируемости
  - GPT-4o-mini оптимален по соотношению цена/качество для MVP
  - Puppeteer обеспечивает надёжную генерацию PDF с кириллицей

#### Infrastructure
- **Hosting:** Vercel
- **Environment:** Vercel Environment Variables для API keys
- **Rationale:**
  - Нативная интеграция с Next.js
  - Автоматический CI/CD из GitHub
  - Бесплатный tier достаточен для MVP

### Последствия
- Быстрая разработка и итерации
- Минимальные издержки на инфраструктуру
- Простой путь к продакшену
- Ограничение: serverless functions имеют timeout (10s на Vercel)

---

## DECISION-002: Структура данных

**Дата:** 2025-10-09  
**Статус:** Утверждено

### Контекст
Необходимо определить чёткую структуру данных для входных параметров и результатов генерации.

### Решение

#### ArtistInput Interface
```typescript
interface ArtistInput {
  name: string;              // Имя артиста
  city: string;              // Город
  genres: string[];          // Жанры (массив)
  venues: string;            // Где играл (текст)
  style: string;             // Стиль/подход
  skills: string;            // Навыки (микс, продакшн и т.д.)
  achievements: string;      // Достижения
  links: {
    instagram?: string;
    soundcloud?: string;
    mixcloud?: string;
    website?: string;
  };
}
```

#### GeneratedBio Interface
```typescript
interface GeneratedBio {
  pitch: string;       // Elevator pitch (2-3 предложения)
  bio: string;         // Full BIO (1 абзац)
  highlights: string[]; // Key highlights (список из 3-5 пунктов)
}
```

### Rationale
- Структура покрывает все необходимые данные для качественного EPK
- Разделение на pitch/bio/highlights обеспечивает гибкость использования
- Optional links позволяют не заполнять все соцсети

### Последствия
- Чёткий контракт между frontend и backend
- Типобезопасность благодаря TypeScript
- Легко расширяемая структура для будущих фич

---

## PROMPT-SPEC-001: Спецификация промптов для GPT

**Дата:** 2025-10-09  
**Статус:** ✅ Утверждено (Задача #5 выполнена)

### System Prompt (финальная версия)
```
Ты профессиональный музыкальный копирайтер, специализирующийся на создании EPK (Electronic Press Kit) для артистов.

Твоя задача — создать профессиональное, привлекательное и точное описание артиста на русском языке на основе предоставленных данных.

Требования:
- Текст на русском языке
- Профессиональный, но не перегруженный стиль
- Фокус на уникальности артиста
- Конкретика: жанры, достижения, опыт
- Избегай клише типа "уникальный звук" без конкретики

Формат ответа строго JSON:
{
  "pitch": "краткий elevator pitch (2-3 предложения, фокус на уникальности и достижениях)",
  "bio": "полное BIO (1 абзац, 4-6 предложений, подробное описание карьеры и стиля)",
  "highlights": ["highlight 1", "highlight 2", "highlight 3", "highlight 4", "highlight 5"]
}

Highlights должны быть конкретными и измеримыми достижениями (релизы, выступления, навыки).
```

### User Prompt Template (функция generateUserPrompt)
```typescript
function generateUserPrompt(artistData: ArtistInput): string {
  return `Создай EPK для артиста со следующими данными:

- Имя: ${name}
- Город: ${city}
- Жанры: ${genres.join(', ')}
- Места выступлений: ${venues}
- Стиль/подход: ${style}
- Навыки: ${skills}
- Достижения: ${achievements}

Создай профессиональное и привлекательное описание, которое подчеркнёт уникальность артиста и его достижения.`;
}
```

### Реализация
- Файл: `lib/prompts.ts`
- Экспорты: `SYSTEM_PROMPT` (константа), `generateUserPrompt(artistData)` (функция)
- Использование: Импортировать в API route `/api/generate-bio`

### OpenAI Configuration
- **Model:** gpt-4o-mini (оптимальное соотношение цена/качество)
- **response_format:** `{ type: 'json_object' }` (для guaranteed JSON response)
- **temperature:** 0.7 (баланс креативности и точности)
- **max_tokens:** 1000 (достаточно для BIO)

---

## PDF-SPEC-001: Спецификация макета PDF

**Дата:** 2025-10-09  
**Статус:** В разработке (будет финализирована в задаче #9)

### Структура документа

1. **Заголовок:**
   - Имя артиста (крупный шрифт, жирный)
   - Подзаголовок: Город, жанры (через запятую)

2. **Секция "Elevator Pitch":**
   - Заголовок секции
   - Текст pitch

3. **Секция "Bio":**
   - Заголовок секции
   - Текст bio (1 абзац)

4. **Секция "Key Highlights":**
   - Заголовок секции
   - Маркированный список highlights

5. **Секция "Links":**
   - Заголовок секции
   - Список активных ссылок (если указаны)

6. **Футер:**
   - Дата создания EPK
   - Опционально: "Created with AI-EPK"

### Технические требования
- **Формат:** A4
- **Шрифты:** С поддержкой кириллицы (системные или embedded)
- **Дизайн:** Минималистичный, профессиональный
- **Отступы:** Достаточные для читаемости
- **Цвета:** Черно-белый или минимальный акцент

### Технология реализации
- **Primary:** Puppeteer (HTML → PDF)
- **Alternative:** react-pdf (если Puppeteer слишком тяжёлый)

### Статус
Финальный макет будет определён в задаче #9 с учётом дизайнерских соображений.

---

## DOD-MVP-001: Definition of Done для MVP

**Дата:** 2025-10-09  
**Статус:** Утверждено

### Критерии готовности

#### Функциональность
- [ ] Форма работает без критических ошибок
- [ ] Валидация обязательных полей корректна
- [ ] GPT генерирует релевантные русскоязычные тексты
- [ ] PDF скачивается с корректным именем
- [ ] PDF корректно отображается (кириллица, структура)
- [ ] Базовый error handling реализован (UI показывает ошибки)

#### Технические требования
- [ ] TypeScript компилируется без ошибок
- [ ] Нет критических linter warnings
- [ ] Код залит в GitHub
- [ ] .env.example создан с необходимыми переменными
- [ ] README.md с описанием проекта и инструкциями по установке

#### User Experience
- [ ] UI выглядит профессионально
- [ ] Loading состояния реализованы
- [ ] Пользователь может повторить генерацию без перезагрузки
- [ ] Текст форм и UI на русском языке

#### Deployment
- [ ] Проект деплоится на Vercel без ошибок
- [ ] Environment variables настроены в Vercel
- [ ] Production build работает корректно

### Критерии НЕ входят в MVP
- Авторизация и user accounts
- Сохранение EPK в базу данных
- Редактирование сгенерированного текста
- Множественные варианты BIO
- Загрузка фото артиста
- Англоязычная версия
- Мобильная адаптивность (nice to have, но не обязательно)

---

## Changelog

**2025-10-09:** Созданы DECISION-001, DECISION-002, черновики PROMPT-SPEC-001, PDF-SPEC-001, DOD-MVP-001

